View(treated)
View(data1997_treated)
View(data1998_treated)
cs <- lm(sc ~ progresa, data = data1998)
summary(cs)
m <- lm(sc ~ progresa + age + dist_sec + sex + hohedu + welfare_index + indig + hohwag , data = data1998)
summary(m)
data1997 <- data %>% filter(year == 97, poor == 'pobre')
a <- mean(data1997['progresa' == 'basal'])
a <- mean(data1997['progresa' == 'basal']$sc)
a <- mean(data1997['progresa' == 'basal']$sc %>% na.omit())
data1997 <- data %>% filter(year == 97, poor == 'pobre')
a <- mean(data1997['progresa' == 'basal']$sc %>% na.omit())
a <- data1997['progresa' == 'basal']
View(a)
data1997 <- data %>% filter(year == 97, poor == 'pobre')
View(data1997)
a <- data1997['progresa' == 'basal']
a <- data1997[progresa == 'basal']
a <- data1997['progresa' == 0]
View(a)
data1997 <- data %>% filter(year == 97, poor == 'pobre')
a <- data1997['progresa' == 0,]
a <- data1997[, 'progresa' == 0]
View(a)
a <- data1997[,'progresa' == 0]
a <- data1997['progresa' == 0,]
a <- data1997[['progresa' == 0]]
a <- data1997 %>% filter(progresa == 'basal')
View(a)
treated97 <- data1997 %>% filter(progresa == 'basal')
untreated97 <- data1997 %>% filter(progresa == 0)
treated98 <- data1998 %>% filter(progresa == 'basal')
treated98 <- data1998 %>% filter(progresa == 0)
untreated98 <- data1998 %>% filter(progresa == 0)
View(treated97)
treated97 <- data1997 %>% filter(progresa == 'basal') %>% na.omit()
untreated97 <- data1997 %>% filter(progresa == 0) %>% na.omit()
treated98 <- data1998 %>% filter(progresa == 'basal') %>% na.omit()
untreated98 <- data1998 %>% filter(progresa == 0) %>% na.omit()
a <- mean(treated98$sc) - mean(treated97$sc)
b <- mean(untreated98$sc) - mean(untreated97$sc)
c <- a - b
a <- mean(treated98$sc) - mean(treated97$sc)
b <- mean(untreated98$sc) - mean(untreated97$sc)
c <- a - b
data1997 <- data %>% filter(year == 97, poor == 'pobre')
treated97 <- data1997 %>% filter(progresa == 'basal') %>% na.omit()
untreated97 <- data1997 %>% filter(progresa == 0) %>% na.omit()
treated98 <- data1998 %>% filter(progresa == 'basal') %>% na.omit()
untreated98 <- data1998 %>% filter(progresa == 0) %>% na.omit()
a <- mean(treated98$sc) - mean(treated97$sc)
b <- mean(untreated98$sc) - mean(untreated97$sc)
c <- a - b
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(summarytools)
library(dplyr)
library(tibble)
library(tidyr)
library(ggplot2)
data <- read.csv("progresa_sample.csv", stringsAsFactors = FALSE)
mydata <- descr(data, transpose = TRUE)[c(-1, -16, -17), 1:2]
mydata <- descr(data, transpose = TRUE)[c(-1, -16, -17), 1:2]
# get mean and sd
t <- as.data.frame(mydata, keep.rownames = TRUE)
# get mean and sd
t <- as.data.frame(mydata, keep.rownames = TRUE)
# get NA count
v <- data.frame(sapply(data, function(x) sum(is.na(x))))
v <- v %>% rownames_to_column("Variables")
# merge them into one table
result <- merge(t, v) %>% arrange(Variables)
colnames(result)[4] <- "NAs"
kable(result)
baseline_poor <- data %>%
filter(poor == "pobre", year == 97) %>%
na.omit()
divided <- baseline_poor %>%
group_by(progresa) %>%
summarize_all(funs(mean))
divided_df <- data.frame(t(divided))[-1, ]
colnames(divided_df) <- c("zero", "basal")
# get rid of poor row
divided_df <- divided_df[-10,]
data1997 <- data %>% filter(year == 97) %>%
select(hohedu, sc) %>%
group_by(hohedu) %>%
na.omit() %>%
summarise(mean = mean(sc))
p <- ggplot(data1997, aes(x=hohedu, y=mean)) + geom_point(color = 'purple') +
geom_smooth(mapping = aes(x = hohedu, y = mean)) +
labs(
title = "1997 Household Head Education vs Average Enrollment",
x = "Head of Household Education",
y = "Average Enrollment"
)
p
# filter to 1997
data1997_treated <- data %>% filter(year == 97, progresa == 'basal', poor == 'pobre') %>%
select(village, sc) %>%
group_by(village) %>%
na.omit() %>%
summarise(mean = mean(sc))
ggplot(data1997_treated, aes(x=mean)) + geom_histogram(binwidth = 0.025, color = 'black') +
geom_vline(aes(xintercept=mean(mean)),
color="blue", size=1) +
labs(
title = "1997 Average Village Enrollment Rates",
x = "Average Enrollment Rate",
y = "# of Villages"
)
library(knitr)
library(summarytools)
library(dplyr)
library(tibble)
library(tidyr)
library(ggplot2)
data <- read.csv("progresa_sample.csv", stringsAsFactors = FALSE)
data1997_hoh <- data %>% filter(year == 97) %>%
select(hohedu, sc) %>%
group_by(hohedu) %>%
na.omit() %>%
summarise(mean = mean(sc))
p <- ggplot(data1997_hoh, aes(x=hohedu, y=mean)) + geom_point(color = 'purple') +
geom_smooth(mapping = aes(x = hohedu, y = mean)) +
labs(
title = "1997 Household Head Education vs Average Enrollment",
x = "Head of Household Education",
y = "Average Enrollment"
)
p
# filter to 1997
data1997_treated <- data %>% filter(year == 97, progresa == 'basal', poor == 'pobre') %>%
select(village, sc) %>%
group_by(village) %>%
na.omit() %>%
summarise(mean = mean(sc))
ggplot(data1997_treated, aes(x=mean)) + geom_histogram(binwidth = 0.025, color = 'black') +
geom_vline(aes(xintercept=mean(mean)),
color="blue", size=1) +
labs(
title = "1997 Average Village Enrollment Rates",
x = "Average Enrollment Rate",
y = "# of Villages"
)
# filter to 1998
data1998_treated <- data %>% filter(year == 98, progresa == 'basal', poor == 'pobre') %>%
select(village, sc) %>%
group_by(village) %>%
na.omit() %>%
summarise(mean = mean(sc))
ggplot(data1998_treated, aes(x=mean)) + geom_histogram(binwidth = 0.025, color = 'black') +
geom_vline(aes(xintercept=mean(mean)),
color="blue", size=1) +
labs(
title = "1998 Average Village Enrollment Rates",
x = "Average Enrollment Rate",
y = "# of Villages"
)
# find p-value
ttest <- t.test(data1997_treated$mean, data1998_treated$mean)
ttest
# For further questions, use 1998 poor data
data1998 <- data %>% filter(year == 98, poor == 'pobre')
# Average village enrollment rate for poor, treated
# data1998_treated
# Average village enrollment rate for poor, untreated
data1998_untreated <- data1998 %>% filter(progresa == 0) %>%
select(village, sc) %>%
group_by(village) %>%
na.omit() %>%
summarise(mean = mean(sc))
# Means
treated_mean <- mean(data1998_treated$mean)
untreated_mean <- mean(data1998_untreated$mean)
# t test
ttest <- t.test(data1998_treated$mean, data1998_untreated$mean)
ttest
cs <- lm(sc ~ progresa, data = data1998)
summary(cs)
m <- lm(sc ~ progresa + age + dist_sec + sex + hohedu + welfare_index + indig + hohwag , data = data1998)
summary(m)
data1997 <- data %>% filter(year == 97, poor == 'pobre')
treated97 <- data1997 %>% filter(progresa == 'basal') %>% na.omit()
untreated97 <- data1997 %>% filter(progresa == 0) %>% na.omit()
treated98 <- data1998 %>% filter(progresa == 'basal') %>% na.omit()
untreated98 <- data1998 %>% filter(progresa == 0) %>% na.omit()
a <- mean(treated98$sc) - mean(treated97$sc)
b <- mean(untreated98$sc) - mean(untreated97$sc)
c <- a - b
# Average enrollment rate for poor, treated
treated <- data1998 %>% filter(progresa == 'basal') %>%
na.omit() %>%
# Average enrollment rate for poor, untreated
data1998_untreated <- data1998 %>% filter(progresa == 0) %>%
select(village, sc) %>%
group_by(village) %>%
na.omit() %>%
summarise(mean = mean(sc))
# Average enrollment rate for poor, treated
treated <- data1998 %>% filter(progresa == 'basal') %>%
na.omit()
View(treated)
# For further questions, use 1998 poor data
data1998 <- data %>% filter(year == 98, poor == 'pobre')
# Average enrollment rate for poor, treated
treated <- data1998 %>% filter(progresa == 'basal') %>%
na.omit()
# Average enrollment rate for poor, untreated
untreated <- data1998 %>% filter(progresa == 0) %>%
na.omit()
# Means
treated_mean <- mean(treated$sc)
untreated_mean <- mean(untreated$sc)
# t test
ttest <- t.test(treated$sc, untreated$sc)
ttest
data_both_years <- data %>% filter(year == 97 | year == 98)
View(data_both_years)
data_both_years <- data %>% filter(year == 97 | year == 98) %>% na.omit()
data_both_years <- data %>% filter(year == 97 | year == 98) %>% na.omit()
did <- lm(sc ~ (progresa * poor) + age + dist_sec + sex + hohedu + welfare_index + indig + hohwag, data = data_both_years)
summary(did)
base_treated <- baseline_poor %>% filter(progresa == 'basal')
baseline_poor <- data %>%
filter(poor == "pobre", year == 97) %>%
na.omit()
base_treated <- baseline_poor %>% filter(progresa == 'basal')
base_untreated <- baseline_poor %>% filter(progresa == 0)
ttest <- t.test(base_treated$sc, base_untreated$sc)
base_treated <- baseline_poor %>% filter(progresa == 'basal')
base_untreated <- baseline_poor %>% filter(progresa == 0)
ttest <- t.test(base_treated$sc, base_untreated$sc)
ttest
View(base_treated)
mydata <- descr(data, transpose = TRUE)[c(-1, -16, -17), 1:2]
mydata <- descr(data, transpose = TRUE)[c(-1, -16, -17), 1:2]
# get mean and sd
t <- as.data.frame(mydata, keep.rownames = TRUE)
# get NA count
v <- data.frame(sapply(data, function(x) sum(is.na(x))))
t <- t %>% rownames_to_column("Variables")
v <- v %>% rownames_to_column("Variables")
v <- v %>% rownames_to_column("Variables")
v <- v %>% rownames_to_column("Variables")
t <- t %>% rownames_to_column("Variables")
# get mean and sd
t <- as.data.frame(mydata, keep.rownames = TRUE)
library(knitr)
library(summarytools)
library(dplyr)
library(tibble)
library(tidyr)
library(ggplot2)
data <- read.csv("progresa_sample.csv", stringsAsFactors = FALSE)
mydata <- descr(data, transpose = TRUE)[c(-1, -16, -17), 1:2]
# get mean and sd
t <- as.data.frame(mydata, keep.rownames = TRUE)
# get NA count
v <- data.frame(sapply(data, function(x) sum(is.na(x))))
t <- t %>% rownames_to_column("Variables")
v <- v %>% rownames_to_column("Variables")
# merge them into one table
result <- merge(t, v) %>% arrange(Variables)
colnames(result)[4] <- "NAs"
baseline_poor <- data %>%
filter(poor == "pobre", year == 97) %>%
na.omit()
base_treated <- baseline_poor %>% filter(progresa == 'basal')
base_untreated <- baseline_poor %>% filter(progresa == 0)
View(mydata)
d <- descr(base_treated, transpose = TRUE)
View(d)
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1]
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2]
g <- d %>% rownames_to_column("Variables")
h <- f %>% rownames_to_column("Variables")
f <- descr(base_untreated, transpose = TRUE)[c(-1, -16, -17), 1:2]
h <- f %>% rownames_to_column("Variables")
View(g)
base_treated <- baseline_poor %>% filter(progresa == 'basal')
base_untreated <- baseline_poor %>% filter(progresa == 0)
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1] %>% rownames_to_column("Variable name")
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
f <- descr(base_untreated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
View(f)
base_treated <- baseline_poor %>% filter(progresa == 'basal')
base_untreated <- baseline_poor %>% filter(progresa == 0)
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
f <- descr(base_untreated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
f <- descr(base_untreated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
df <- merge(d, f) %>% arrange(Variables)
View(df)
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
f <- descr(base_untreated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
f <- descr(base_untreated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
df <- merge(d, f)
View(df)
View(t)
View(v)
colnames(d)[2] <- "Average value (treatment villages)"
colnames(f)[2] <- "Average value (controlled villages)"
# get rid of sd
d <- d[,1:2]
f <- f[,1:2]
df <- merge(d, f)
View(df)
df['Difference (Treat - Control)'] = df$`Average value (treatment villages)` - df$`Average value (controlled villages)`
ttest
p.value = function (x,y){
PV=as.numeric(t.test(x,y)[3])
}
p.value(df$`Average value (treatment villages)`, df$`Average value (controlled villages)`)
a <- p.value(df$`Average value (treatment villages)`, df$`Average value (controlled villages)`)
a <- p.value(df$`Average value (treatment villages)`, df$`Average value (controlled villages)`)
xxx <- apply(df, 1, function(x) p.value(df$`Average value (treatment villages)`,df$`Average value (controlled villages)`))
xxx
xxx <- apply(df$`Variable name`, 1, function(x) p.value(df$`Average value (treatment villages)`,df$`Average value (controlled villages)`))
xxx <- apply(df, 1, function(x) p.value(df$`Average value (treatment villages)`,df$`Average value (controlled villages)`))
mytea <- apply(df, 2, t.test)
mytea <- apply(df, 1, t.test)
xxx <- apply(df, 1, function(x) t.test(df$`Average value (treatment villages)`,df$`Average value (controlled villages)`))
View(xxx)
xxx <- apply(df, 1, function(df) t.test(df$`Average value (treatment villages)`,df$`Average value (controlled villages)`))
results <- apply(df, 1, function(df) {
t.test(x = dat[1:x], y = dat[(x + 1):(x + y)])$p.value})
results <- apply(df, 1, function(df) {
t.test(x = df[1:x], y = df[(x + 1):(x + y)])$p.value})
h <- get_p('sex')
get_p <- function(v) {
a <- base_treated$v
}
h <- get_p('sex')
h
base_treated$sex
get_p <- function(v) {
a <- base_treated$v
a
}
h <- get_p('sex')
h
get_p <- function(variable) {
a <- base_treated$variable
a
}
h <- get_p('sex')
h
get_p <- function(col_a, col_b) {
t <- t.test(col_a, col_b)
t['p.value']
}
h <- get_p(base_treated$sc, base_untreated$sc)
View(h)
ttest <- t.test(base_treated$sc, base_untreated$sc)
ttest['p.value']
h
p_age <- get_p(base_treated$age, base_untreated$age)
p_dist_cap <- get_p(base_treated$dist_cap, base_untreated$dist_cap)
p_dist_sec <- get_p(base_treated$dist_sec, base_untreated$dist_sec)
p_age
p_dist_cap
p_dist_sec
# get all the p values we want
p_age <- get_p(base_treated$age, base_untreated$age)
p_dist_cap <- get_p(base_treated$dist_cap, base_untreated$dist_cap)
p_dist_sec <- get_p(base_treated$dist_sec, base_untreated$dist_sec)
p_fam_n <- get_p(base_treated$fam_n, base_untreated$fam_n)
p_age_grc <- get_p(base_treated$grc, base_untreated$grc)
p_age_grc97 <- get_p(base_treated$grc97, base_untreated$grc97)
p_hohage <- get_p(base_treated$hohage, base_untreated$hohage)
p_hohedu <- get_p(base_treated$hohedu, base_untreated$hohedu)
p_hohsex <- get_p(base_treated$hohsex, base_untreated$hohsex)
p_hohwag <- get_p(base_treated$hohwag, base_untreated$hohwag)
p_indig <- get_p(base_treated$indig, base_untreated$indig)
p_min_dist <- get_p(base_treated$min_dist, base_untreated$min_dist)
p_sc <- get_p(base_treated$sc, base_untreated$sc)
p_sc97 <- get_p(base_treated$sc97, base_untreated$sc97)
p_sex <- get_p(base_treated$sex, base_untreated$sex)
p_welfare <- get_p(base_treated$welfare_index, base_untreated$welfare_index)
p_grc <- get_p(base_treated$grc, base_untreated$grc)
p_grc97 <- get_p(base_treated$grc97, base_untreated$grc97)
y <- 'sex
y <- 'sex'
y <- 'sex'
base_treated[y]
u <- base_treated[y]
View(u)
# function that gets p value of 2 columns
get_p <- function(var) {
t <- t.test(base_treated[var], base_untreated[var])
t['p.value']
}
# get all the p values we want
p_age <- get_p('age')
p_age
p_sc <- get_p('sc')
p_sc
p_age <- get_p('age')
p_dist_cap <- get_p('dist_cap')
p_dist_sec <- get_p('dist_sec')
p_fam_n <- get_p('fam_n')
p_grc <- get_p('grc')
p_grc97 <- get_p('grc97')
p_hohage <- get_p('hohage')
p_hohedu <- get_p('hohedu')
p_hohsex <- get_p('hohsex')
p_hohwag <- get_p('hohwag')
p_indig <- get_p('indig')
p_min_dist <- get_p('min_dist')
p_sc <- get_p('sc')
p_sc97 <- get_p('sc97')
p_sex <- get_p('sex')
p_welfare <- get_p('welfare_index')
p_values <- c(p_age, p_dist_cap, p_dist_sec, p_fam_n, p_grc, p_grc97, p_hohage, p_hohedu, p_hohsex, p_hohwag, p_indig, p_min_dist, p_sc, p_sc97, p_sex, p_welfare)
View(p_values)
df['p-value'] = p_values
baseline_poor <- data %>%
filter(poor == "pobre", year == 97) %>%
na.omit()
baseline_poor <- data %>%
filter(poor == "pobre", year == 97) %>%
na.omit()
base_treated <- baseline_poor %>% filter(progresa == 'basal')
# grab summary stats for treated and untreated
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
# grab summary stats for treated and untreated
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
f <- descr(base_untreated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
colnames(d)[2] <- "Average value (treatment villages)"
f <- descr(base_untreated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
colnames(d)[2] <- "Average value (treatment villages)"
colnames(f)[2] <- "Average value (controlled villages)"
# get rid of sd
d <- d[,1:2]
f <- f[,1:2]
df <- merge(d, f)
df['Difference (Treat - Control)'] = df$`Average value (treatment villages)` - df$`Average value (controlled villages)`
p_values
merge(df, p_values)
d <- merge(df, p_values)
View(d)
df['p-value'] = p_values
p_values <- list(p_age, p_dist_cap, p_dist_sec, p_fam_n, p_grc, p_grc97, p_hohage, p_hohedu, p_hohsex, p_hohwag, p_indig, p_min_dist, p_sc, p_sc97, p_sex, p_welfare)
df['p-value'] = p_values
d <- data.frame(df, p_values)
View(d)
p_values <- c(p_age, p_dist_cap, p_dist_sec, p_fam_n, p_grc, p_grc97, p_hohage, p_hohedu, p_hohsex, p_hohwag, p_indig, p_min_dist, p_sc, p_sc97, p_sex, p_welfare)
d <- data.frame(df, p_values)
View(d)
baseline_poor <- data %>%
filter(poor == "pobre", year == 97) %>%
na.omit()
base_treated <- baseline_poor %>% filter(progresa == 'basal')
base_untreated <- baseline_poor %>% filter(progresa == 0)
# grab summary stats for treated and untreated
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
# grab summary stats for treated and untreated
d <- descr(base_treated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
f <- descr(base_untreated, transpose = TRUE)[c(-1, -16, -17), 1:2] %>% rownames_to_column("Variable name")
colnames(d)[2] <- "Average value (treatment villages)"
colnames(f)[2] <- "Average value (controlled villages)"
# get rid of sd
d <- d[,1:2]
f <- f[,1:2]
df <- merge(d, f)
df['Difference (Treat - Control)'] = df$`Average value (treatment villages)` - df$`Average value (controlled villages)`
df['Difference (Treat - Control)'] = df$`Average value (treatment villages)` - df$`Average value (controlled villages)`
# function that gets p value of 2 columns
get_p <- function(var) {
t <- t.test(base_treated[var], base_untreated[var])
t['p.value']
}
# get all the p values we want
p_age <- get_p('age')
p_dist_sec <- get_p('dist_sec')
p_fam_n <- get_p('fam_n')
p_grc <- get_p('grc')
p_grc97 <- get_p('grc97')
p_hohage <- get_p('hohage')
p_hohedu <- get_p('hohedu')
p_hohsex <- get_p('hohsex')
p_hohwag <- get_p('hohwag')
p_indig <- get_p('indig')
p_min_dist <- get_p('min_dist')
p_sc <- get_p('sc')
p_sc97 <- get_p('sc97')
p_sex <- get_p('sex')
p_welfare <- get_p('welfare_index')
p_values <- c(p_age, p_dist_cap, p_dist_sec, p_fam_n, p_grc, p_grc97, p_hohage, p_hohedu, p_hohsex, p_hohwag, p_indig, p_min_dist, p_sc, p_sc97, p_sex, p_welfare)
d <- data.frame(df, p_values)
d <- data.frame(p_values)
View(d)
d <- t(data.frame(p_values))
d
df['p_value'] <- d
p_values
View(data)
A <- matrix(c(1, 2, 3), 1, 3, byrow = TRUE)
A
B <- matrix(c(1, 2, 3), 3, 1, byrow = TRUE)
B
A %*% B
a <- matrix(1:9, 3, 3)
a
Matrix::rankMatrix(a)
